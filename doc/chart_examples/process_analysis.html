<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üñ•Ô∏è Process Analysis - CPU &amp; Memory Usage</title>

    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/date-fns@2.29.3/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --border-color: #dee2e6;
            --panel-bg: #f8f9fa;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .control-panel {
            background-color: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .chart-container {
            background-color: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            position: relative;
        }

        .stats-panel {
            background-color: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .field-selector {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 10px;
        }

        .export-buttons {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
        }

        .btn-outline-primary {
            color: var(--text-color);
            border-color: var(--border-color);
        }

        .btn-outline-primary:hover {
            background-color: #0d6efd;
            border-color: #0d6efd;
            color: white;
        }

        
    </style>
</head>
<body>
    <div class="container-fluid">
        
        <div class="row mt-3">
            <div class="col-12">
                <h1 class="text-center">üñ•Ô∏è Process Analysis - CPU &amp; Memory Usage</h1>
            </div>
        </div>

        
        <div class="row">
            <div class="col-12">
                <div class="control-panel">
                    <div class="row g-3">
                        
                        <div class="col-md-2">
                            <label class="form-label">Chart Type</label>
                            <select id="chartType" class="form-select">
                                <option value="line">Line</option>
                                <option value="bar">Bar</option>
                                <option value="scatter">Scatter</option>
                                <option value="pie">Pie</option>
                                <option value="doughnut">Doughnut</option>
                                <option value="radar">Radar</option>
                            </select>
                        </div>

                        
                        <div class="col-md-2">
                            <label class="form-label">X-Axis Field</label>
                            <select id="xField" class="form-select">
                            </select>
                        </div>

                        
                        <div class="col-md-3">
                            <label class="form-label">Y-Axis Fields</label>
                            <div id="yFields" class="field-selector">
                            </div>
                        </div>

                        
                        <div class="col-md-2">
                            <label class="form-label">Options</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="showTrendLine">
                                <label class="form-check-label" for="showTrendLine">Trend Line</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="showMovingAvg">
                                <label class="form-check-label" for="showMovingAvg">Moving Average</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="stackedMode">
                                <label class="form-check-label" for="stackedMode">Stacked</label>
                            </div>
                        </div>

                        
                        <div class="col-md-3">
                            <label class="form-label">Actions</label>
                            <div class="btn-group d-block" role="group">
                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="updateChart()">
                                    <i class="bi bi-arrow-clockwise"></i> Update
                                </button>
                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="resetZoom()">
                                    <i class="bi bi-zoom-out"></i> Reset Zoom
                                </button>
                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="exportChart()">
                                    <i class="bi bi-download"></i> Export
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        
        <div class="row">
            <div class="col-12">
                <div class="chart-container">
                    <canvas id="mainChart"></canvas>
                </div>
            </div>
        </div>

        
        <div class="row">
            <div class="col-12">
                <div class="stats-panel">
                    <h5>Data Summary</h5>
                    <div id="dataSummary" class="row">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        
        let chartData = {"records":[{"CMD":"/bin/systemd","CPU":9.84152222226041,"MEM":10.331190067250109,"PID":1000,"STAT":"T","SZ":10579,"TIME":1089,"USER":"root"},{"CMD":"/bin/systemd","CPU":16.126754084924148,"MEM":971.1663714037196,"PID":1001,"STAT":"T","SZ":994474,"TIME":2692,"USER":"postgres"},{"CMD":"/usr/bin/postgres","CPU":19.657459336242844,"MEM":857.1474127515692,"PID":1002,"STAT":"S","SZ":877718,"TIME":2744,"USER":"postgres"},{"CMD":"/usr/bin/memcached","CPU":1.9675355186290462,"MEM":27.594716675365436,"PID":1003,"STAT":"D","SZ":28256,"TIME":3590,"USER":"nginx"},{"CMD":"/usr/bin/node","CPU":6.838429550657094,"MEM":559.8803849152607,"PID":1004,"STAT":"D","SZ":573317,"TIME":3157,"USER":"postgres"},{"CMD":"/usr/sbin/sshd","CPU":4.95002057764517,"MEM":36.91903380339096,"PID":1005,"STAT":"D","SZ":37805,"TIME":1427,"USER":"nginx"},{"CMD":"/usr/bin/postgres","CPU":6.262989636315121,"MEM":61.35503951746145,"PID":1006,"STAT":"T","SZ":62827,"TIME":3015,"USER":"root"},{"CMD":"/usr/bin/memcached","CPU":3.814620668241023,"MEM":60.077982695542005,"PID":1007,"STAT":"S","SZ":61519,"TIME":3568,"USER":"monitoring"},{"CMD":"/usr/bin/memcached","CPU":1.3774689367570168,"MEM":54.566092374050484,"PID":1008,"STAT":"D","SZ":55875,"TIME":803,"USER":"nginx"},{"CMD":"/usr/bin/postgres","CPU":6.157337665790536,"MEM":60.89550689425759,"PID":1009,"STAT":"S","SZ":62356,"TIME":691,"USER":"monitoring"},{"CMD":"/usr/bin/node","CPU":4.5423756645441795,"MEM":15.302084538252165,"PID":1010,"STAT":"S","SZ":15669,"TIME":3010,"USER":"app"},{"CMD":"/usr/bin/python3","CPU":2.563633832937362,"MEM":69.93218867265227,"PID":1011,"STAT":"D","SZ":71610,"TIME":2334,"USER":"root"},{"CMD":"/usr/sbin/sshd","CPU":7.864142074696003,"MEM":92.55554026264848,"PID":1012,"STAT":"R","SZ":94776,"TIME":336,"USER":"app"},{"CMD":"/usr/sbin/nginx","CPU":1.4703329904978641,"MEM":85.222243536705,"PID":1013,"STAT":"D","SZ":87267,"TIME":3065,"USER":"app"},{"CMD":"/usr/bin/memcached","CPU":5.4578714051583415,"MEM":10.523875985145747,"PID":1014,"STAT":"R","SZ":10776,"TIME":413,"USER":"nginx"},{"CMD":"/usr/bin/postgres","CPU":2.233209300521722,"MEM":18.334023626507722,"PID":1015,"STAT":"S","SZ":18774,"TIME":3333,"USER":"nginx"},{"CMD":"/usr/bin/memcached","CPU":3.7714972464897154,"MEM":47.73574176883581,"PID":1016,"STAT":"R","SZ":48881,"TIME":1963,"USER":"nginx"},{"CMD":"/usr/sbin/nginx","CPU":5.242380745692705,"MEM":101.59124397549998,"PID":1017,"STAT":"D","SZ":104029,"TIME":1507,"USER":"root"},{"CMD":"/usr/bin/python3","CPU":9.763830491319306,"MEM":72.94578032361831,"PID":1018,"STAT":"D","SZ":74696,"TIME":2359,"USER":"app"},{"CMD":"/usr/sbin/sshd","CPU":4.838464208145373,"MEM":10.938921204924512,"PID":1019,"STAT":"T","SZ":11201,"TIME":2668,"USER":"monitoring"},{"CMD":"/usr/sbin/nginx","CPU":14.557469177675133,"MEM":923.0024222608436,"PID":1020,"STAT":"D","SZ":945154,"TIME":2642,"USER":"postgres"},{"CMD":"/usr/bin/redis-server","CPU":10.763332623013557,"MEM":972.2051709897753,"PID":1021,"STAT":"D","SZ":995538,"TIME":2353,"USER":"postgres"},{"CMD":"/usr/bin/memcached","CPU":2.440730354878652,"MEM":39.21316322680474,"PID":1022,"STAT":"D","SZ":40154,"TIME":3508,"USER":"app"},{"CMD":"/usr/sbin/sshd","CPU":7.253310099078323,"MEM":37.99654330988957,"PID":1023,"STAT":"D","SZ":38908,"TIME":1040,"USER":"app"},{"CMD":"/usr/bin/memcached","CPU":6.42651379499736,"MEM":442.276686208923,"PID":1024,"STAT":"S","SZ":452891,"TIME":1313,"USER":"postgres"},{"CMD":"/usr/sbin/sshd","CPU":5.255353145597833,"MEM":17.624969740068675,"PID":1025,"STAT":"D","SZ":18047,"TIME":907,"USER":"nginx"},{"CMD":"/usr/bin/node","CPU":9.350062490742575,"MEM":32.273729911847006,"PID":1026,"STAT":"S","SZ":33048,"TIME":670,"USER":"app"},{"CMD":"/usr/bin/python3","CPU":4.771149790368965,"MEM":53.01209986214175,"PID":1027,"STAT":"D","SZ":54284,"TIME":1718,"USER":"nginx"},{"CMD":"/usr/bin/node","CPU":3.8671899170518964,"MEM":52.2399888055637,"PID":1028,"STAT":"R","SZ":53493,"TIME":389,"USER":"app"},{"CMD":"/usr/bin/node","CPU":0.03208034415354676,"MEM":102.42348224790133,"PID":1029,"STAT":"S","SZ":104881,"TIME":678,"USER":"app"},{"CMD":"/usr/sbin/nginx","CPU":15.84137748248254,"MEM":204.4077515586294,"PID":1030,"STAT":"S","SZ":209313,"TIME":3463,"USER":"postgres"},{"CMD":"/usr/bin/redis-server","CPU":5.892770472439582,"MEM":41.12243613413151,"PID":1031,"STAT":"S","SZ":42109,"TIME":765,"USER":"root"},{"CMD":"/usr/bin/memcached","CPU":8.582043177937878,"MEM":6.4945013335175705,"PID":1032,"STAT":"R","SZ":6650,"TIME":1401,"USER":"root"},{"CMD":"/usr/bin/postgres","CPU":9.802727144077675,"MEM":83.04562738085195,"PID":1033,"STAT":"D","SZ":85038,"TIME":2152,"USER":"root"},{"CMD":"/usr/sbin/sshd","CPU":6.379228128994174,"MEM":599.4987947444026,"PID":1034,"STAT":"S","SZ":613886,"TIME":1363,"USER":"postgres"},{"CMD":"/usr/bin/redis-server","CPU":7.702712693096176,"MEM":33.77163695904039,"PID":1035,"STAT":"D","SZ":34582,"TIME":477,"USER":"root"},{"CMD":"/usr/bin/memcached","CPU":2.6872591042677043,"MEM":58.96738561024067,"PID":1036,"STAT":"T","SZ":60382,"TIME":1137,"USER":"nginx"},{"CMD":"/usr/sbin/nginx","CPU":16.24052107574393,"MEM":259.76367057118574,"PID":1037,"STAT":"R","SZ":265997,"TIME":2440,"USER":"postgres"},{"CMD":"/usr/sbin/sshd","CPU":5.181756519292597,"MEM":72.57295617340856,"PID":1038,"STAT":"D","SZ":74314,"TIME":139,"USER":"monitoring"},{"CMD":"/usr/bin/memcached","CPU":6.797282264006528,"MEM":59.26018371035358,"PID":1039,"STAT":"R","SZ":60682,"TIME":2489,"USER":"app"},{"CMD":"/usr/bin/node","CPU":5.579596368683932,"MEM":54.4953651049757,"PID":1040,"STAT":"D","SZ":55803,"TIME":1517,"USER":"nginx"},{"CMD":"/usr/bin/postgres","CPU":0.3865837803969284,"MEM":78.44686641145974,"PID":1041,"STAT":"T","SZ":80329,"TIME":2412,"USER":"root"},{"CMD":"/usr/sbin/sshd","CPU":14.262321898827205,"MEM":361.6248481162139,"PID":1042,"STAT":"S","SZ":370303,"TIME":510,"USER":"postgres"},{"CMD":"/usr/sbin/sshd","CPU":0.7976815629461074,"MEM":51.25497855547515,"PID":1043,"STAT":"D","SZ":52485,"TIME":1446,"USER":"root"},{"CMD":"/usr/bin/memcached","CPU":15.918736911271175,"MEM":573.6335664194595,"PID":1044,"STAT":"S","SZ":587400,"TIME":2966,"USER":"postgres"},{"CMD":"/usr/bin/redis-server","CPU":3.622060123158382,"MEM":67.5661253884096,"PID":1045,"STAT":"D","SZ":69187,"TIME":519,"USER":"app"},{"CMD":"/usr/bin/postgres","CPU":3.911767798548493,"MEM":69.00234797445957,"PID":1046,"STAT":"S","SZ":70658,"TIME":2278,"USER":"monitoring"},{"CMD":"/usr/bin/postgres","CPU":6.906987206739496,"MEM":514.1143640894404,"PID":1047,"STAT":"T","SZ":526453,"TIME":522,"USER":"postgres"},{"CMD":"/usr/bin/redis-server","CPU":7.2685453614791005,"MEM":67.37815538196645,"PID":1048,"STAT":"S","SZ":68995,"TIME":1438,"USER":"root"},{"CMD":"/usr/bin/postgres","CPU":2.8288277925745664,"MEM":99.918235058599,"PID":1049,"STAT":"S","SZ":102316,"TIME":1671,"USER":"monitoring"}],"fields":["CMD","CPU","MEM","PID","STAT","SZ","TIME","USER"],"numericFields":["CPU","MEM","PID","SZ","TIME"],"dateFields":[],"categories":{"CMD":["/bin/systemd","/usr/bin/postgres","/usr/bin/memcached","/usr/bin/node","/usr/sbin/sshd","/usr/bin/python3","/usr/sbin/nginx","/usr/bin/redis-server"],"STAT":["T","S","D","R"],"USER":["root","postgres","nginx","monitoring","app"]},"summary":{"recordCount":50,"fieldTypes":{"CMD":"string","CPU":"numeric","MEM":"numeric","PID":"numeric","STAT":"string","SZ":"numeric","TIME":"numeric","USER":"string"},"numericStats":{"CPU":{"min":0.03208034415354676,"max":19.657459336242844,"mean":6.720997095239739,"stdDev":4.572721413963797,"count":50},"MEM":{"min":6.4945013335175705,"max":972.2051709897753,"mean":185.07246856465278,"stdDev":268.25317221839924,"count":50},"PID":{"min":1000,"max":1049,"mean":1024.5,"stdDev":14.430869689661812,"count":50},"SZ":{"min":6650,"max":995538,"mean":189513.7,"stdDev":274691.2386964136,"count":50},"TIME":{"min":139,"max":3590,"mean":1801.74,"stdDev":1025.8991726285776,"count":50}}}};
        let chartConfig = {"title":"üñ•Ô∏è Process Analysis - CPU \u0026 Memory Usage","width":1300,"height":600,"chartType":"scatter","timeFormat":"","xAxisType":"category","yAxisType":"linear","showLegend":true,"showTooltips":true,"enableZoom":true,"enablePan":true,"enableAnimations":true,"showDataLabels":false,"enableInteractive":true,"enableCalculations":true,"colorScheme":"pastel","theme":"light","exportFormats":["png","csv"],"customCSS":"","fields":{}};
        let mainChart = null;

        
        document.addEventListener('DOMContentLoaded', function() {
            initializeControls();
            createChart();
            updateDataSummary();
        });

        
        function initializeControls() {
            
            const xFieldSelect = document.getElementById('xField');
            const yFieldsDiv = document.getElementById('yFields');

            chartData.fields.forEach(field => {
                
                const option = document.createElement('option');
                option.value = field;
                option.textContent = field;
                xFieldSelect.appendChild(option);

                
                const checkDiv = document.createElement('div');
                checkDiv.className = 'form-check';
                checkDiv.innerHTML = `
                    <input class="form-check-input" type="checkbox" id="y_${field}" value="${field}">
                    <label class="form-check-label" for="y_${field}">${field}</label>
                `;
                yFieldsDiv.appendChild(checkDiv);
            });

            
            if (chartData.fields.length > 0) {
                xFieldSelect.value = chartData.fields[0];
            }

            
            chartData.numericFields.forEach(field => {
                const checkbox = document.getElementById(`y_${field}`);
                if (checkbox) {
                    checkbox.checked = true;
                }
            });

            
            document.getElementById('chartType').value = chartConfig.chartType;
        }

        
        function createChart() {
            const ctx = document.getElementById('mainChart').getContext('2d');

            if (mainChart) {
                mainChart.destroy();
            }

            const chartType = document.getElementById('chartType').value;
            const xField = document.getElementById('xField').value;
            const selectedYFields = getSelectedYFields();
            const showTrendLine = document.getElementById('showTrendLine').checked;
            const showMovingAvg = document.getElementById('showMovingAvg').checked;
            const stackedMode = document.getElementById('stackedMode').checked;

            
            const labels = chartData.records.map(record => record[xField]);
            const datasets = [];

            
            const colors = generateColors(selectedYFields.length);

            selectedYFields.forEach((field, index) => {
                const data = chartData.records.map(record => {
                    const value = record[field];
                    return typeof value === 'number' ? value : parseFloat(value) || 0;
                });

                datasets.push({
                    label: field,
                    data: data,
                    backgroundColor: colors[index] + '80', 
                    borderColor: colors[index],
                    borderWidth: 2,
                    fill: chartType === 'area',
                    tension: 0.4
                });

                
                if (showMovingAvg && data.length > 5) {
                    const movingAvgData = calculateMovingAverage(data, 5);
                    datasets.push({
                        label: `${field} (5-period MA)`,
                        data: movingAvgData,
                        backgroundColor: 'transparent',
                        borderColor: colors[index],
                        borderWidth: 1,
                        borderDash: [5, 5],
                        fill: false,
                        tension: 0.1,
                        pointRadius: 0
                    });
                }
            });

            
            const config = {
                type: chartType,
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: chartData.dateFields.includes(xField) ? 'time' : 'category',
                            title: {
                                display: true,
                                text: xField
                            }
                        },
                        y: {
                            stacked: stackedMode,
                            title: {
                                display: true,
                                text: 'Values'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: chartConfig.showLegend
                        },
                        tooltip: {
                            enabled: chartConfig.showTooltips,
                            mode: 'index',
                            intersect: false
                        },
                        zoom: {
                            zoom: {
                                wheel: {
                                    enabled: chartConfig.enableZoom
                                },
                                pinch: {
                                    enabled: chartConfig.enableZoom
                                },
                                mode: 'x'
                            },
                            pan: {
                                enabled: chartConfig.enablePan,
                                mode: 'x'
                            }
                        }
                    },
                    animation: {
                        duration: chartConfig.enableAnimations ? 1000 : 0
                    }
                }
            };

            mainChart = new Chart(ctx, config);
        }

        
        function getSelectedYFields() {
            const checkboxes = document.querySelectorAll('#yFields input[type="checkbox"]:checked');
            return Array.from(checkboxes).map(cb => cb.value);
        }

        function generateColors(count) {
            const colors = [
                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
                '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#36A2EB'
            ];

            const result = [];
            for (let i = 0; i < count; i++) {
                result.push(colors[i % colors.length]);
            }
            return result;
        }

        function calculateMovingAverage(data, period) {
            const result = [];
            for (let i = 0; i < data.length; i++) {
                if (i < period - 1) {
                    result.push(null);
                } else {
                    const sum = data.slice(i - period + 1, i + 1).reduce((a, b) => a + b, 0);
                    result.push(sum / period);
                }
            }
            return result;
        }

        function updateChart() {
            createChart();
        }

        function resetZoom() {
            if (mainChart) {
                mainChart.resetZoom();
            }
        }

        function exportChart() {
            if (mainChart) {
                const url = mainChart.toBase64Image();
                const link = document.createElement('a');
                link.download = 'chart.png';
                link.href = url;
                link.click();
            }
        }

        function updateDataSummary() {
            const summaryDiv = document.getElementById('dataSummary');
            let html = `
                <div class="col-md-3">
                    <strong>Records:</strong> ${chartData.summary.recordCount}
                </div>
                <div class="col-md-3">
                    <strong>Fields:</strong> ${chartData.fields.length}
                </div>
                <div class="col-md-3">
                    <strong>Numeric Fields:</strong> ${chartData.numericFields.length}
                </div>
                <div class="col-md-3">
                    <strong>Date Fields:</strong> ${chartData.dateFields.length}
                </div>
            `;

            
            for (const [field, stats] of Object.entries(chartData.summary.numericStats)) {
                html += `
                    <div class="col-md-12 mt-2">
                        <small><strong>${field}:</strong>
                        Min: ${stats.min.toFixed(2)},
                        Max: ${stats.max.toFixed(2)},
                        Mean: ${stats.mean.toFixed(2)},
                        StdDev: ${stats.stdDev.toFixed(2)}
                        </small>
                    </div>
                `;
            }

            summaryDiv.innerHTML = html;
        }
    </script>
</body>
</html>